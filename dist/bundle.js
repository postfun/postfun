(()=>{"use strict";$((function(){let e,t,a,n=$("#happening-feed").attr("url"),i={page:1,elements:7,count:0,pageNum:0,window:5,feedSize:0,elementPerRow:1,currentEvent:1},l={"pop-up":!1,wide:!1,search:!1},d={elementWidth:300,wide:""},s={image_url:"https://events.umich.edu/images/default-events-module.png",permalink:"https://events.umich.edu/",event_title:"See whats Happening @ Michigan",date_start:"",location_name:"",links:""},c=new Set,o=new Set;$("#happening-feed").append('<div class = "loader-container feed-container center"><div class="loader"></div></div>');function r(){let e,t,n,d="";i.count=Object.keys(a).length,i.pageNum=0==Math.ceil(i.count/i.elements)?1:Math.ceil(i.count/i.elements),$("#event-feed").empty(),e=(i.page-1)*i.elements,t=e+i.elements<i.count?e+i.elements:i.count;for(let l=e;l<=t;l++)(l-e)%i.elementPerRow==0&&(n='<div class="event-row feed-container">',$("#event-feed").append('<div class="event-row feed-container">')),d=l==t?h(s,-1):h(a[l],l),$(".event-row").last().append(d);0==i.count&&(d="<h3>No events found. Please modify your search and try again</h3>",$(".event-row").last().append(d)),l["pop-up"]&&($(".event-modal-button").click((function(){$("#feed-modal").show(),i.currentEvent=$(this).val(),p(a[i.currentEvent])})),$(".event-title").click((function(){i.currentEvent=$(this).val(),-1==i.currentEvent?window.open(s.permalink):($("#feed-modal").show(),p(a[i.currentEvent]))}))),function(){$("#pagination-wrapper").empty();let e="",t=i.page-Math.floor(i.window/2),a=i.page+Math.floor(i.window/2);t<1&&(t=1,a=i.window),a>i.pageNum&&(t=i.pageNum-(i.window-1),a=i.pageNum,t<1&&(t=1));for(let n=t;n<=a;n++)e+="<button value = "+n+" class = page-button>"+n+"</button>";1!=i.page&&(e='<button value=1 class = "page-button">&#171; First</button>'+e),i.page!=i.pageNum&&(e+="<button value="+i.pageNum+' class="page-button">Last &#187;</button>'),$("#pagination-wrapper").append(e),$(".page-button").on("click",(function(){i.page=Number($(this).val()),r(),$(".page-button").filter((function(){return this.value==i.page})).addClass("current-page")}))}()}function h(e,t){let a='<div class="event'+d.wide+'" style="flex:0 0 '+100/i.elementPerRow+'%">',n=e.image_url?e.image_url:"https://events.umich.edu/images/default190@2x.png",s='<a class = "image-link" href ='+e.permalink+'><div class = "event-image'+d.wide+'" style="background-image: url('+n+')"></div></a>',c=e.event_title,o=e.date_start,r=e.links,h=e.location_name;a+=s,a+='<div class = "event-text'+d.wide+'">',l["pop-up"]?a+='<button value = "'+t+'" class = "event-title"><h3>'+c+"</h3></button>":a+="<a href ="+e.permalink+"><h3>"+c+"</h3></a>",o&&(a+='<ul><li><i class="fa fa-fw fa-calendar"></i><span> Date: '+o+"</span></li>"),h&&(a+='<li><i class="fa fa-location-arrow fa-fw"></i><span> Location: '+h+"</span></li></ul>");for(let e=0;e<Object.keys(r).length;e++){let t=r[e].url.split("://")[1];t=t.split("/")[0];let n=null==r[e].title?t:r[e].title;link='<i class="fa fa-link fa-fw maize"></i><a href = '+r[e].url+"> "+n+"</a><br>",e%2==0&&(a+="<div class = feed-container>"),a+='<div class = "link-container">'+link+"</div>",e%2==0&&e!=Object.keys(r).length-1||(a+="</div>")}return a+="</div>",l["pop-up"]&&-1!=t&&(a+='<button value = "'+t+'" class = "event-modal-button">Read More</button>'),a+="</div>",a}function p(e){let t,a,n="<h2>"+e.event_title+"</h2>",i=e.image_url?e.image_url:"https://events.umich.edu/images/default190@2x.png",l='<div class = "feed-modal-side">',d=e.time_start.substring(0,2),s=e.time_start.substring(3,5),c=parseInt(d)>=12?"pm":"am";$("#feed-modal-header h2, #feed-modal-header h4").remove(),$("#feed-modal-body").empty(),$("#feed-modal-event-link").remove(),""!=e.event_subtitle&&(n+="<h4>"+e.event_subtitle+"</h4>"),$("#feed-modal-header").append(n),l+='<div class = "feed-modal-image" style="background-image: url('+i+')"></div>',$(window).width()>800&&(l+=u(e)),l+="</div>",l+='<div class = "feed-modal-main"><div class= "feed-modal-text">',l+=e.description,l+='</div><hr><ul><li><i class="fa fa-fw fa-calendar"></i>',l+="<span> "+e.date_start.replaceAll("-","/")+"</span></li>",d=(d+11)%12+1,t=d+":"+s+c,d=e.time_end.substring(0,2),s=e.time_end.substring(3,5),c=parseInt(d)>=12?"pm":"am",d=(d+11)%12+1,a=d+":"+s+c,l+='<li><i class="fa fa-fw fa-clock-o"></i><span> '+t+" - "+a+"</span></li>",e.location_name&&(l+='<li><i class="fa fa-location-arrow fa-fw"></i><span> Location: '+e.location_name+"</span></li>"),l+="</ul></div>",$(window).width()<=800&&(l+=u(e)),$("#feed-modal-body").append(l),$("#feed-modal-body").after('<a id = "feed-modal-event-link" href ='+e.permalink+">View on Happening @ Michigan</a>")}function u(e){let t=e.links,a="";if(Object.keys(t).length>0){a+='<div class = "small-title">related link</div>';for(let e=0;e<Object.keys(t).length;e++){let n=t[e].url.split("://")[1];n=n.split("/")[0];let i=null==t[e].title?n:t[e].title;link='<i class="fa fa-link fa-fw blue"></i><a class = "feed-modal-link" href = '+t[e].url+"> "+i+"</a><br>",a+=link}}return a}function f(){if($("#search-input").val()){let e=$("#search-input").val().toLowerCase(),n=new Set,i=0;a=t.filter((t=>t.event_type.toLowerCase().includes(e)));for(let e=i;e<Object.keys(a).length;e++)n.add(a[e].id);i=Object.keys(a).length,a=a.concat(t.filter((t=>t.tags.find((t=>t.toLowerCase().includes(e)))&&!n.has(t.id))));for(let e=i;e<Object.keys(a).length;e++)n.add(a[e].id);i=Object.keys(a).length,a=a.concat(t.filter((t=>(t.event_title.toLowerCase().includes(e)||t.building_name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e))&&!n.has(t.id))))}else a=t;i.page=1,r()}$.ajax({url:n,success:function(s){let h,p,u,v,m,g,b;if($("#happening-feed").empty(),h=$("#happening-feed").attr("class"),p=h.split(/\s+/),p.forEach((e=>{"pop-up"==e?l["pop-up"]=!0:"wide"==e?(l.wide=!0,d.wide="-wide",d.elementWidth=480):"search"==e&&(l.search=!0)})),l.search&&(u='<div class = "feed-search feed-container center"><div id = "search-content" class = "search-content"><h3>Search Events</h3>',u+='<input id= "search-input" class = "search-input" type="text" placeholder="Search.."></input><div class = "advance-search-toggle-container"><a id = "advance-search-toggle">advance search</a><div>',$("#happening-feed").append('<div class = "feed-search feed-container center"><div id = "search-content" class = "search-content"><h3>Search Events</h3><input id= "search-input" class = "search-input" type="text" placeholder="Search.."></input><div class = "advance-search-toggle-container"><a id = "advance-search-toggle">advance search</a><div>'),$("#search-input").on("keyup",(function(){f()})),$("#advance-search-toggle").on("click",(function(){0===$("#advance-search").height()?function(e,t){let a=e.height(),n=e.css("height","auto").height();e.height(a),e.stop().animate({height:n},500,(function(){$("#advance-search").css("height","auto")}))}($("#advance-search")):$("#advance-search").stop().animate({height:"0"},500)}))),v='<div id = "event-feed"></div>',$("#happening-feed").append('<div id = "event-feed"></div>'),m=n.replace("/json",""),g='<div class = "feed-container center link-to-happening"><a href = "'+m+'">View the full page on Happening @ Michigan</a></div>',$("#happening-feed").append(g),b='<div class = "feed-container center"><div id="pagination-wrapper"></div></div>',$("#happening-feed").append('<div class = "feed-container center"><div id="pagination-wrapper"></div></div>'),l["pop-up"]){let e='<div id="feed-modal" class="feed-modal"><div class="feed-modal-content"><div id = "feed-modal-header" class="feed-modal-header"><span id = "feed-modal-close" class="feed-modal-close">&times;</span></div><div id = "feed-modal-body" class="feed-modal-body feed-modal-row"></div></div></div>';$("#happening-feed").append(e),$("#feed-modal-close").on("click",(function(){$("#feed-modal").hide()}))}e=s,t=e,a=t,i.feedSize=$("#event-feed").width(),i.elementPerRow=Math.floor(i.feedSize/d.elementWidth)>=1?Math.floor(i.feedSize/d.elementWidth):1,r(),l.search&&function(){let a='<div id = "advance-search" class = "advance-search"><div class = "container-fluid"><div class = "row">';for(let t=0;t<e.length;t++){for(let a=0;a<e[t].tags.length;a++)c.add(e[t].tags[a]);o.add(e[t].event_type)}a+='<div class = "col-sm-6 search-container"><label for = "search-start-date">Start Date: </label><br><input type = "date" id = "search-start-date" class = "search-date"></div>',a+='<div class = "col-sm-6 search-container"><label for = "search-end-date">End Date: </label><br><input type = "date" id = "search-end-date" class = "search-date"></div>',a+="</div>",a+='<div class = "row type-row"><div class = "col-sm-6 search-container">',a+='<label for = "type-checkbox">Event types:</label><br>',a+='<div class = "search-checkbox-container">',o.forEach((e=>{a+='<input type="checkbox" class = "type-checkbox" value ="'+e+'"><label for="'+e+'"> '+e+"</label><br>"})),a+="</div></div>",a+='<div class = "col-sm-6 search-container">',a+='<label for = "tag-checkbox">Event tags:&nbsp</label><input id = "tag-search-input" class = "tag-search-input" type="text" placeholder="Search Tags.."></input><br>',a+='<div class = "search-checkbox-container">',c.forEach((e=>{a+='<div><input type="checkbox" class = "tag-checkbox" value ="'+e+'"><label for="'+e+'" class = "tag-label"> '+e+"</label></div>"})),a+="</div></div></div>",a+='<div class = "advance-search-button-container"><button id = "search-clear" class = "search-clear">Clear Search</button><button id = "advance-search-submit" class = "advance-search-submit">Submit</button></div></div>',$("#search-content").append(a),$("#tag-search-input").on("keyup",(function(){!function(){let e=$("#tag-search-input").val().toLowerCase();$(".tag-checkbox").filter((function(){$(this).toggle($(this).val().toLowerCase().indexOf(e)>-1)})),$(".tag-label").filter((function(){$(this).toggle($(this).text().toLowerCase().indexOf(e)>-1)}))}()})),$("#advance-search-submit").on("click",(function(){$("#advance-search").stop().animate({height:"0"},500),function(){let a=new Set,n=new Set;t=e,$(".type-checkbox").each((function(){$(this).is(":checked")&&a.add($(this).val())})),$(".tag-checkbox").each((function(){$(this).is(":checked")&&n.add($(this).val())})),0!=a.size?(t=t.filter((e=>a.has(e.event_type))),0!=n.size&&(t=t.concat(e.filter((function(e){for(tag of e.tags)if(n.has(tag))return!0;return!1}))))):0!=n.size&&(t=t.filter((function(e){for(tag of e.tags)if(n.has(tag))return!0;return!1}))),$("#search-start-date").val()&&(t=t.filter((e=>e.date_start>=$("#search-start-date").val()))),$("#search-end-date").val()&&(t=t.filter((e=>e.date_start<=$("#search-end-date").val()))),f()}()})),$("#search-clear").on("click",(function(){$("#search-start-date").val(""),$("#search-end-date").val(""),$("input:checkbox").each((function(){$(this).prop("checked",!1)})),$("#tag-search-input").val(""),$("#search-input").val(""),t=e,f()}))}()}}),$(window).resize((function(){i.feedSize=$("#happening-feed").width(),i.elementPerRow!=Math.floor(i.feedSize/d.elementWidth)&&(i.elementPerRow=Math.floor(i.feedSize/d.elementWidth)>=1?Math.floor(i.feedSize/d.elementWidth):1,r()),p(a[i.currentEvent])})),$(window).click((function(e){e.target==$("#feed-modal")[0]&&$("#feed-modal").hide()}))})),new Feed({url:"https://feeds.castos.com/owg73"}).load(((e,t)=>{e?console.error("Error fetching RSS feed:",e):(function(e){const t=document.getElementById("episode-list");for(const a of e){const e=document.createElement("li"),n=document.createElement("h3");n.textContent=a.title,e.appendChild(n);const i=document.createElement("p");i.textContent=a.description,e.appendChild(i);const l=document.createElement("div");l.setAttribute("data-plyr-provider","podcast"),l.setAttribute("data-plyr-embed-id","episode-"+a.id),e.appendChild(l),t.appendChild(e)}}(t),Plyr.setup().then((()=>{document.querySelectorAll("data-plyr-provider").forEach((e=>{new Plyr(e)}))})))}))})();